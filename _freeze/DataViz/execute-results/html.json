{
  "hash": "ae9670c4883d1ab82a318829357a8998",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Visualization\"\nformat: html\n---\n\n\n\n\n\n\n\n\nPurpose: visualize long-term population estimate, redd count, and spawning weir data from multiple YCT populations in the upper Snake River watershed. \n\n## Data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# mark-recapture population estimates\npopest <- read_csv(\"C:/Users/jbaldock/OneDrive - DOI/Documents/WyACT/Snake River Assessment/Population data/PopulationEstimates_WGFD_1988-2022_cleaned.csv\") %>%\n  mutate(Nperkm_total = Npermile_total/1.60934)\n\n# spring creek redd counts\nreddcts <- read_csv(\"C:/Users/jbaldock/OneDrive - DOI/Documents/WyACT/Snake River Assessment/Population data/ReddCounts_WGFD_1971-2021_cleaned.csv\")\n\n# lower bar bc weir (latent run size following run timing model)\nweir <- read_csv(\"C:/Users/jbaldock/OneDrive - DOI/Documents/WyACT/Snake River Assessment/Population data/RunTiming_TopModel_MalFem2_ParameterSummary.csv\")\nnames(weir) <- c(\"param\", \"mean\", \"sd\", \"ci025\", \"ci_250\", \"ci_500\", \"ci_750\", \"ci_975\", \"Rhat\", \"n.eff\")\nweirtib <- tibble(year = rep(NA, times = 55),\n                  param = rep(NA, times = 55),\n                  total_mean = rep(NA, times = 55),\n                  total_sd = rep(NA, times = 55))\nweirtib$year <- c(1965:1990, 1992:2015, 2017:2021)\nfor (i in 1:55) {\n  weirtib$param[i] <- unlist(weir[i+174,1]) # parameter name\n  weirtib$total_mean[i] <- unlist(weir[i+174,2]) # mean total run size\n  weirtib$total_sd[i] <- unlist(weir[i+174,3]) # SD total run size\n}\n```\n:::\n\n\n\n\n\n\n\n## Mark-Recapture\n\nView all data:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopest %>% \n  ggplot(aes(x = year, y = Nperkm_total)) +\n  geom_point() + #geom_line() +\n  facet_wrap(~site)\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nRestrict to sites with >10 years of data:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopest %>% \n  filter(site %in% c(\"Flat_NowlinSleigh\", \"GrosVentre_ParkBoundary-Kelly\", \"Hoback_LowerHoback\", \"Salt_Narrows-Hwy238\", \"Salt_AuburnGrover-Christiansen\", \"Salt_Etna\", \"Snake_Wilson-SouthPark\", \"Snake_Moose-Wilson\", \"Snake_Deadmans-Moose\")) %>%\n  mutate(site = recode(site, \n                       \"Snake_Deadmans-Moose\" = \"Snake River: Deadmans-Moose\", \n                       \"Snake_Moose-Wilson\" = \"Snake River: Moose-Wilson\", \n                       \"Snake_Wilson-SouthPark\" = \"Snake River: Wilson-South Park\", \n                       \"GrosVentre_ParkBoundary-Kelly\" = \"Gros Ventre River\", \n                       \"Flat_NowlinSleigh\" = \"Flat Creek\", \n                       \"Hoback_LowerHoback\" = \"Hoback River (lower)\",  \n                       \"Salt_AuburnGrover-Christiansen\" = \"Salt River: Auburn-Christiansen\", \n                       \"Salt_Narrows-Hwy238\" = \"Salt River: The Narrows\", \n                       \"Salt_Etna\" = \"Salt River: Etna\")) %>%\n  mutate(site = factor(site, levels = c(\"Snake River: Deadmans-Moose\", \"Snake River: Moose-Wilson\", \"Snake River: Wilson-South Park\", \n                                        \"Gros Ventre River\", \"Flat Creek\", \"Hoback River (lower)\",  \n                                        \"Salt River: Auburn-Christiansen\", \"Salt River: The Narrows\", \"Salt River: Etna\"))) %>%\n  ggplot(aes(x = year, y = Nperkm_total)) +\n  #geom_smooth() +\n  geom_point() +\n  facet_wrap(~site, ncol = 3) + \n  xlab(\"Year\") + ylab(\"YCT per km\") + #ylim(0,900) +\n  theme_bw() + theme(panel.grid = element_blank(), axis.text = element_text(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nAdd LOESS smoothers and plot on unique scales:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopest %>% \n  filter(site %in% c(\"Flat_NowlinSleigh\", \"GrosVentre_ParkBoundary-Kelly\", \"Hoback_LowerHoback\", \"Salt_Narrows-Hwy238\", \"Salt_AuburnGrover-Christiansen\", \"Salt_Etna\", \"Snake_Wilson-SouthPark\", \"Snake_Moose-Wilson\", \"Snake_Deadmans-Moose\")) %>%\n  mutate(site = recode(site, \n                       \"Snake_Deadmans-Moose\" = \"Snake River: Deadmans-Moose\", \n                       \"Snake_Moose-Wilson\" = \"Snake River: Moose-Wilson\", \n                       \"Snake_Wilson-SouthPark\" = \"Snake River: Wilson-South Park\", \n                       \"GrosVentre_ParkBoundary-Kelly\" = \"Gros Ventre River\", \n                       \"Flat_NowlinSleigh\" = \"Flat Creek\", \n                       \"Hoback_LowerHoback\" = \"Hoback River (lower)\",  \n                       \"Salt_AuburnGrover-Christiansen\" = \"Salt River: Auburn-Christiansen\", \n                       \"Salt_Narrows-Hwy238\" = \"Salt River: The Narrows\", \n                       \"Salt_Etna\" = \"Salt River: Etna\")) %>%\n  mutate(site = factor(site, levels = c(\"Snake River: Deadmans-Moose\", \"Snake River: Moose-Wilson\", \"Snake River: Wilson-South Park\", \n                                        \"Gros Ventre River\", \"Flat Creek\", \"Hoback River (lower)\",  \n                                        \"Salt River: Auburn-Christiansen\", \"Salt River: The Narrows\", \"Salt River: Etna\"))) %>%\n  ggplot(aes(x = year, y = Nperkm_total)) +\n  geom_smooth() +\n  geom_point() +\n  facet_wrap(~site, ncol = 3, scales = \"free_y\") + \n  xlab(\"Year\") + ylab(\"YCT per km\") + #ylim(0,900) +\n  theme_bw() + theme(panel.grid = element_blank(), axis.text = element_text(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n## Redd Counts\n\nView all data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreddcts %>%\n  ggplot(aes(x = year, y = reddsperkm)) +\n  geom_point() +\n  facet_wrap(~stream) \n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nDrop Cody Creek (only 4 years or data) and fix names\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreddcts %>%\n  filter(stream != \"Cody\") %>%\n  mutate(stream = recode(stream, \"3 Channel\" = \"Three Channel\", \"Snake River Side Channel\" = \"SR Side Channel\")) %>%\n  mutate(stream = factor(stream, levels = c(\"Cowboy Cabin\", \"Upper Bar BC\", \"SR Side Channel\", \"Blacktail\",\n                                            \"Three Channel\", \"Price\", \"Lower Bar BC\", \"Little Bar BC\", \"Fish\", \n                                            \"Flat\", \"Nowlin\", \"Spring\", \"Blue Crane\", \"Dave\", \"Laker\", \"Christiansen\"))) %>%\n  ggplot(aes(x = year, y = reddsperkm)) +\n  #geom_smooth() +\n  geom_point() +\n  facet_wrap(~stream) + \n  xlab(\"Year\") + ylab(\"Redds per km\") + #ylim(0,900) +\n  theme_bw() + theme(panel.grid = element_blank(), axis.text = element_text(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-7-1.png){width=768}\n:::\n:::\n\n\n\n\n\n\nAdd LOESS smoothers and plot on unique scales:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreddcts %>%\n  filter(stream != \"Cody\") %>%\n  mutate(stream = recode(stream, \"3 Channel\" = \"Three Channel\", \"Snake River Side Channel\" = \"SR Side Channel\")) %>%\n  mutate(stream = factor(stream, levels = c(\"Cowboy Cabin\", \"Upper Bar BC\", \"SR Side Channel\", \"Blacktail\",\n                                            \"Three Channel\", \"Price\", \"Lower Bar BC\", \"Little Bar BC\", \"Fish\", \n                                            \"Flat\", \"Nowlin\", \"Spring\", \"Blue Crane\", \"Dave\", \"Laker\", \"Christiansen\"))) %>%\n  ggplot(aes(x = year, y = reddsperkm)) +\n  geom_smooth() +\n  geom_point() +\n  facet_wrap(~stream, scales = \"free_y\") + \n  xlab(\"Year\") + ylab(\"Redds per km\") + #ylim(0,900) +\n  theme_bw() + theme(panel.grid = element_blank(), axis.text = element_text(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-8-1.png){width=768}\n:::\n:::\n\n\n\n\n\n\n\n## Weir\n\nPlot time series of YCT spawning abundance in Lower Bar BC (enumerated at the WGFD weir). Abundance data are corrected for interannual variation in monitoring period using a run timing model as in Baldock *et al.* (2023, CJFAS).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweirtib %>%\n  ggplot(aes(x = year, y = total_mean)) +\n  geom_point() + geom_line() +\n  xlab(\"Year\") + ylab(\"YCT spawning abundance\") + ylim(0,max(weirtib$total_mean)) +\n  theme_bw() + theme(panel.grid = element_blank(), axis.text = element_text(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nAdd LOESS smoother:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweirtib %>%\n  ggplot(aes(x = year, y = total_mean)) +\n  geom_smooth() +\n  geom_point() + geom_line() +\n  xlab(\"Year\") + ylab(\"YCT spawning abundance\") + ylim(0,max(weirtib$total_mean)) +\n  theme_bw() + theme(panel.grid = element_blank(), axis.text = element_text(color = \"black\"))\n```\n\n::: {.cell-output-display}\n![](DataViz_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}